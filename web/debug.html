<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Admin Panel</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .btn { padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .btn:hover { background: #0056b3; }
        .status { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Debug Admin Panel</h1>
    <div id="status"></div>

    <div>
        <h2>Test Functions</h2>
        <button class="btn" id="testAdminPanel">Test AdminPanel Object</button>
        <button class="btn" id="testSync">Test Sync Function</button>
        <button class="btn" id="testEditDelete">Test Edit/Delete Buttons</button>
        <button class="btn" id="testRefresh">Refresh Table</button>
    </div>

    <div>
        <h2>Console Output</h2>
        <pre id="consoleOutput">Console output will appear here...</pre>
    </div>

    <script>
        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
            setTimeout(() => status.innerHTML = '', 3000);
        }

        function log(message) {
            const consoleOutput = document.getElementById('consoleOutput');
            const timestamp = new Date().toLocaleTimeString();
            consoleOutput.textContent += `[${timestamp}] ${message}\n`;
            console.log(message);
        }

        // Test adminPanel object
        document.getElementById('testAdminPanel').addEventListener('click', () => {
            log('Testing adminPanel object...');
            try {
                if (window.adminPanel) {
                    log('✓ adminPanel object exists');
                    log('adminPanel methods:', Object.getOwnPropertyNames(Object.getPrototypeOf(window.adminPanel)).filter(name => typeof window.adminPanel[name] === 'function'));
                    showStatus('adminPanel object is available', 'success');
                } else {
                    log('✗ adminPanel object does NOT exist');
                    showStatus('adminPanel object is NOT available', 'error');
                }
            } catch (error) {
                log('Error testing adminPanel: ' + error.message);
                showStatus('Error testing adminPanel: ' + error.message, 'error');
            }
        });

        // Test sync function
        document.getElementById('testSync').addEventListener('click', () => {
            log('Testing sync function...');
            try {
                if (typeof syncFromGoogleSheets === 'function') {
                    log('✓ syncFromGoogleSheets function is available');
                    showStatus('syncFromGoogleSheets function is available', 'success');
                } else {
                    log('✗ syncFromGoogleSheets function is NOT available');
                    showStatus('syncFromGoogleSheets function is NOT available', 'error');
                }
            } catch (error) {
                log('Error testing sync: ' + error.message);
                showStatus('Error testing sync: ' + error.message, 'error');
            }
        });

        // Test edit/delete buttons
        document.getElementById('testEditDelete').addEventListener('click', () => {
            log('Testing edit/delete button detection...');
            try {
                const editBtns = document.querySelectorAll('.edit-btn');
                const deleteBtns = document.querySelectorAll('.delete-btn');

                log(`Found ${editBtns.length} edit buttons and ${deleteBtns.length} delete buttons`);

                if (editBtns.length > 0) {
                    log('✓ Edit buttons are rendered');
                } else {
                    log('✗ No edit buttons found');
                }

                if (deleteBtns.length > 0) {
                    log('✓ Delete buttons are rendered');
                } else {
                    log('✗ No delete buttons found');
                }

                showStatus(`Found ${editBtns.length} edit and ${deleteBtns.length} delete buttons`, 'success');
            } catch (error) {
                log('Error testing buttons: ' + error.message);
                showStatus('Error testing buttons: ' + error.message, 'error');
            }
        });

        // Test refresh table
        document.getElementById('testRefresh').addEventListener('click', () => {
            log('Testing table refresh...');
            try {
                if (window.adminPanel && typeof window.adminPanel.refreshTable === 'function') {
                    window.adminPanel.refreshTable();
                    log('✓ Table refreshed');
                    showStatus('Table refreshed', 'success');
                } else {
                    log('✗ Cannot refresh table');
                    showStatus('Cannot refresh table', 'error');
                }
            } catch (error) {
                log('Error refreshing table: ' + error.message);
                showStatus('Error refreshing table: ' + error.message, 'error');
            }
        });

        // Check on page load
        window.addEventListener('load', () => {
            setTimeout(() => {
                log('Page loaded, checking environment...');

                // Check if we're in admin panel
                if (document.getElementById('adminContainer')) {
                    log('✓ Admin panel detected');
                } else {
                    log('✗ Not in admin panel');
                }

                // Check adminPanel
                if (window.adminPanel) {
                    log('✓ adminPanel object is available');
                } else {
                    log('✗ adminPanel object is NOT available');
                }

                log('Debug page ready');
                showStatus('Debug page loaded', 'success');
            }, 1000);
        });
    </script>
</body>
</html>

